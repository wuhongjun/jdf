/* jdf-1.0.0/ myjd.js Date:2015-05-20 18:02:39 */
define("jdf/1.0.0/unit/myjd/1.0.0/myjd.js",["jdf/1.0.0/unit/login/1.0.0/login.js","jdf/1.0.0/ui/dropdown/1.0.0/dropdown.js","jdf/1.0.0/unit/getjsonp/1.0.0/getjsonp.js","jdf/1.0.0/unit/trimPath/1.0.0/trimPath.js","jdf/1.0.0/unit/globalReco/1.0.0/globalReco.js"],function(require){var c=require("jdf/1.0.0/unit/login/1.0.0/login.js");require("jdf/1.0.0/ui/dropdown/1.0.0/dropdown.js");require("jdf/1.0.0/unit/getjsonp/1.0.0/getjsonp.js");require("jdf/1.0.0/unit/trimPath/1.0.0/trimPath.js");var g=require("jdf/1.0.0/unit/globalReco/1.0.0/globalReco.js");pageConfig.FN_StringFormat=function(){var a=arguments[0],b=arguments.length;if(b>0)for(var c=0;b>c;c++)a=a.replace(new RegExp("\\{"+c+"\\}","g"),arguments[c+1]);return a};var h={init:function(){var b=$(document.getElementById("my360buy")?"#my360buy":"#my360buy-2013");b&&b.find("dl").dropdown({enterDelay:100,trigger:!0,current:"hover",onchange:function(a){if(!a.attr("load")){function b(a){$.ajax({url:"http://api.credit.wangyin.com/veyron/query/queryCreditJsonp",type:"get",dataType:"jsonp",data:{platform:1,userId:readCookie("pin"),productId:-1},success:function(b){b&&b[0]&&a(b[0].productId)}})}c({automatic:!0,complete:function(c){if(c){var d=a.find("dd").eq(0),e="";var f=c.Identity.IsAuthenticated;f?(e+=h.TPL_Regist.process(c.Identity),e+=h.TPL_OList.placeholder,e+=h.TPL_UList):(e+=h.TPL_UnRegist,e+=h.TPL_UList),e+=h.TPL_VList.placeholder,d.html(e),readCookie("pin")?b(function(a){"3"==a?d.find(".J_jincai").show():d.find(".J_baitiao").show()}):d.find(".J_baitiao").show(),a.attr("load","1"),setTimeout(function(){a.removeAttr("load")},6e4),f&&h.FN_InitOList(),h.FN_InitRecent()}}})}}})},DATA_Cookie:"aview",TPL_UnRegist:'<div class="prompt">				<span class="fl">\u60a8\u597d\uff0c\u8bf7<a href="javascript:login()" clstag="homepage|keycount|home2013|04a">\u767b\u5f55</a></span>				<span class="fr"></span>			</div>',TPL_Regist:'<div class="prompt">					<span class="fl"><strong>${Unick}</strong></span>					<span class="fr"><a href="http://home.jd.com/">\u53bb\u6211\u7684\u4eac\u4e1c\u9996\u9875&nbsp;&gt;</a></span>				</div>',TPL_OList:{placeholder:'<div id="jduc-orderlist"></div>',fragment:'<div class="orderlist">					<div class="smt">						<h4>\u6700\u65b0\u8ba2\u5355\u72b6\u6001\uff1a</h4>						<div class="extra"><a href="http://order.jd.com/center/list.action" target="_blank">\u67e5\u770b\u6240\u6709\u8ba2\u5355&nbsp;&gt;</a></div>					</div>					<div class="smc">						<ul>							{for item in orderList}							<li class="fore${parseInt(item_index)+1}">								<div class="p-img fl">									{for image in item.OrderDetail}										{if image_index<2}											<a href="http://www.jd.com/product/${image.ProductId}.html" target="_blank"><img src="${pageConfig.FN_GetImageDomain(image.ProductId)}n5/${image.ImgUrl}" width="50" height="50" alt="${image.ProductName}" /></a>										{/if}									{/for}									{if item.OrderDetail.length>2}										<a href="${item.passKeyUrl}" target="_blank" class="more">\u66f4\u591a</a>									{/if}								</div>								<div class="p-detail fr">									\u8ba2\u5355\u53f7\uff1a${item.OrderId}<br />									\u72b6\u3000\u6001\uff1a<span>${UC.FN_SetState(item.OrderState)}</span><br />									\u3000\u3000\u3000\u3000<a href="${item.passKeyUrl}">\u67e5\u770b\u8be6\u60c5</a>								</div>							</li>							{/for}						</ul>					</div>				</div>'},TPL_UList:'<div class="uclist">                <ul class="fore1 fl">                    <li><a target="_blank" clstag="homepage|keycount|home2013|04b" href="http://order.jd.com/center/list.action">\u5f85\u5904\u7406\u8ba2\u5355<span id="num-unfinishedorder"></span></a></li>                    <li><a target="_blank" clstag="homepage|keycount|home2013|04c" href="http://club.jd.com/myjd/userConsultationList_1.html">\u54a8\u8be2\u56de\u590d<span id="num-consultation"></span></a></li>                    <li><a target="_blank" clstag="homepage|keycount|home2013|04d" href="http://t.jd.com/product/followProductList.action?isReduce=true">\u964d\u4ef7\u5546\u54c1<span id="num-reduction"></span></a></li>                    <li><a target="_blank" clstag="homepage|keycount|home2013|shouhou" href="http://myjd.jd.com/repair/orderlist.action">\u8fd4\u4fee\u9000\u6362\u8d27</a></li>                    <li><a target="_blank" clstag="homepage|keycount|home2013|04e" href="http://quan.jd.com/user_quan.action">\u4f18\u60e0\u5238<span id="num-ticket"></span></a></li>                </ul>                <ul class="fore2 fl">                    <li><a target="_blank" clstag="homepage|keycount|home2013|04i" href="http://t.jd.com/home/follow">\u6211\u7684\u5173\u6ce8&nbsp;&gt;</a></li>                    <li><a target="_blank" clstag="homepage|keycount|home2013|04g" href="http://bean.jd.com/myJingBean/list">\u6211\u7684\u4eac\u8c46&nbsp;&gt;</a></li>                    <li><a target="_blank" clstag="homepage|keycount|home2013|licai" href="http://trade.jr.jd.com/centre/browse.action">\u6211\u7684\u7406\u8d22&nbsp;&gt;</a></li>                    <li class="J_baitiao hide"><a target="_blank" clstag="homepage|keycount|home2013|baitiao" href="http://baitiao.jd.com/creditUser/list">\u6211\u7684\u767d\u6761&nbsp;&gt;</a></li>                    <li class="J_jincai hide"><a target="_blank" clstag="homepage|keycount|home2013|jincai" href="http://baitiao.jd.com/jinCai/record">\u4eac\u4e1c\u91d1\u91c7&nbsp;&gt;</a></li>                </ul>            </div>',TPL_VList:{placeholder:'<div class="viewlist">                    <div class="smt" clstag="homepage|keycount|home2013|04k">                        <h4>\u6700\u8fd1\u6d4f\u89c8\u7684\u5546\u54c1\uff1a</h4>                        <div style="float:right;padding-right:9px;"><a style="border:0;color:#005EA7" href="http://my.jd.com/history/list.html" target="_blank">\u67e5\u770b\u6d4f\u89c8\u5386\u53f2&nbsp;&gt;</a></div>                    </div>                    <div class="smc" id="jduc-viewlist" clstag="homepage|keycount|home2013|04j">                        <div class="loading-style1"><b></b>\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u5019...</div>                        <ul class="lh hide"></ul>                    </div>                </div>',fragment:'<ul class="lh">{for item in data}<li data-clk="${item.clk}"><a href="http://item.jd.com/${item.sku}.html" target="_blank" title="${item.t}"><img src="${pageConfig.FN_GetImageDomain(item.sku)}n5/${item.img}" width="50" height="50" alt="${item.t}" /></a></li>{/for}</ul>'},FN_SetState:function(a){var a=a;return a.length>4&&(a="<span title="+a+">"+a.substr(0,4)+"...</span>"),a},FN_InitRecent:function(){new g({$el:$("#jduc-viewlist"),skuHooks:"SKUS_recent_view",template:h.TPL_VList.fragment,param:{p:202001,sku:"",ck:"pin,ipLocation,atw,aview",lim:5},callback:function(){}})},FN_ShowVList:function(a){if(a){var b=$("#jduc-viewlist").find(".loading-style1");a.length=a.length>5?5:a.length;var c={list:a};b.length>0&&b.hide();var d=this.TPL_VList.fragment.process(c);$("#jduc-viewlist").find("ul").eq(0).html(d).show()}},FN_setWords:function(a){var b='<font style="color:{0}">({1})</font>',c="";return c=0==a?"#ccc":"#c00",pageConfig.FN_StringFormat(b,c,a)},FN_InitOList:function(){$.ajax({url:"http://minijd.jd.com/getOrderList",dataType:"jsonp",success:function(a){if(a&&0==a.error&&a.orderList){var b=h.TPL_OList.fragment.process(a);try{$("#jduc-orderlist").html(b)}catch(c){}}}}),$.ajax({url:"http://minijd.jd.com/getHomeCount",dataType:"jsonp",success:function(a){a&&0==a.error&&$("#num-unfinishedorder").html(h.FN_setWords(a.orderCount))}}),$.ajax({url:"http://comm.360buy.com/index.php?mod=Consultation&action=havingReplyCount",dataType:"jsonp",success:function(a){a&&$("#num-consultation").html(h.FN_setWords(a.cnt))}}),$.ajax({url:"http://follow.soa.jd.com/product/queryForReduceProductCount.action?",dataType:"jsonp",success:function(a){a&&a.data>0&&$("#num-reduction").html(h.FN_setWords(a.data))}}),$.ajax({url:"http://quan.jd.com/getcouponcount.action",dataType:"jsonp",success:function(a){a&&$("#num-ticket").html(h.FN_setWords(a.CouponCount))}})}};window.UC=h;function i(){h.init()}return i});
